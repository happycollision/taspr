services:
  # Development with minimum supported git (2.40)
  dev:
    build:
      context: ..
      dockerfile: docker/Dockerfile.dev
      args:
        GIT_VERSION: "2.40.0"
    volumes:
      - ..:/workspace
      - node_modules:/workspace/node_modules
    working_dir: /workspace
    stdin_open: true
    tty: true
    environment:
      - GH_TOKEN=${GH_TOKEN:-}
    command: bash

  # Development with old git (2.38) for testing error handling
  dev-old-git:
    build:
      context: ..
      dockerfile: docker/Dockerfile.dev
      args:
        GIT_VERSION: "2.38.5"
    volumes:
      - ..:/workspace
      - node_modules_old:/workspace/node_modules
    working_dir: /workspace
    stdin_open: true
    tty: true
    environment:
      - GH_TOKEN=${GH_TOKEN:-}
    command: bash

volumes:
  node_modules:
  node_modules_old:
